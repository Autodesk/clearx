/** @license
 * Autodesk clearx
 * Date: 2019-04-19
 * License: Apache-2.0
 *
 * Bundled dependencies (npm packages): 
 * {"package":"fast-deep-equal@2.0.1","license":"MIT","link":"https://github.com/epoberezkin/fast-deep-equal#readme"}, {"package":"deepmerge@3.1.0","license":"MIT","link":"https://github.com/KyleAMathews/deepmerge"}, {"package":"object-path@0.11.4","license":"MIT","link":"https://github.com/mariocasciaro/object-path"}
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).ClearX=e()}(this,function(){"use strict";"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;function t(t,e){return t(e={exports:{}},e.exports),e.exports}var u=t(function(t){t.exports=function(){var e=Object.prototype.toString;function o(t,e){return null!=t&&Object.prototype.hasOwnProperty.call(t,e)}function f(t){if(!t)return!0;if(p(t)&&0===t.length)return!0;if("string"==typeof t)return!1;for(var e in t)if(o(t,e))return!1;return!0}function l(t){return e.call(t)}var p=Array.isArray||function(t){return"[object Array]"===e.call(t)};function h(t){var e=parseInt(t);return e.toString()===t?e:t}function t(i){i=i||{};var s=function(n){return Object.keys(s).reduce(function(t,e){return"create"===e||"function"==typeof s[e]&&(t[e]=s[e].bind(s,n)),t},{})};function a(t,e){return i.includeInheritedProps||"number"==typeof e&&Array.isArray(t)||o(t,e)}function u(t,e){if(a(t,e))return t[e]}function c(t,e,n,r){if("number"==typeof e&&(e=[e]),!e||0===e.length)return t;if("string"==typeof e)return c(t,e.split(".").map(h),n,r);var i=e[0],o=u(t,i);return 1===e.length?(void 0!==o&&r||(t[i]=n),o):(void 0===o&&("number"==typeof e[1]?t[i]=[]:t[i]={}),c(t[i],e.slice(1),n,r))}return s.has=function(t,e){if("number"==typeof e?e=[e]:"string"==typeof e&&(e=e.split(".")),!e||0===e.length)return!!t;for(var n=0;n<e.length;n++){var r=h(e[n]);if(!("number"==typeof r&&p(t)&&r<t.length||(i.includeInheritedProps?r in Object(t):o(t,r))))return!1;t=t[r]}return!0},s.ensureExists=function(t,e,n){return c(t,e,n,!0)},s.set=function(t,e,n,r){return c(t,e,n,r)},s.insert=function(t,e,n,r){var i=s.get(t,e);r=~~r,p(i)||(i=[],s.set(t,e,i)),i.splice(r,0,n)},s.empty=function(t,e){var n,r;if(!f(e)&&null!=t&&(n=s.get(t,e))){if("string"==typeof n)return s.set(t,e,"");if("boolean"==typeof(o=n)||"[object Boolean]"===l(o))return s.set(t,e,!1);if("number"==typeof n)return s.set(t,e,0);if(p(n))n.length=0;else{if("object"!=typeof(i=n)||"[object Object]"!==l(i))return s.set(t,e,null);for(r in n)a(n,r)&&delete n[r]}var i,o}},s.push=function(t,e){var n=s.get(t,e);p(n)||(n=[],s.set(t,e,n)),n.push.apply(n,Array.prototype.slice.call(arguments,2))},s.coalesce=function(t,e,n){for(var r,i=0,o=e.length;i<o;i++)if(void 0!==(r=s.get(t,e[i])))return r;return n},s.get=function(t,e,n){if("number"==typeof e&&(e=[e]),!e||0===e.length)return t;if(null==t)return n;if("string"==typeof e)return s.get(t,e.split("."),n);var r=h(e[0]),i=u(t,r);return void 0===i?n:1===e.length?i:s.get(t[r],e.slice(1),n)},s.del=function(t,e){if("number"==typeof e&&(e=[e]),null==t)return t;if(f(e))return t;if("string"==typeof e)return s.del(t,e.split("."));var n=h(e[0]);return a(t,n)?1!==e.length?s.del(t[n],e.slice(1)):(p(t)?t.splice(n,1):delete t[n],t):t},s}var n=t();return n.create=t,n.withInheritedProps=t({includeInheritedProps:!0}),n}()}),i=t(function(t,e){t.exports=function(){var f=function(t){return!(!(r=t)||"object"!=typeof r||(e=t,"[object RegExp]"===(n=Object.prototype.toString.call(e))||"[object Date]"===n||e.$$typeof===i));var e,n,r},i="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function l(t,e){return!1!==e.clone&&e.isMergeableObject(t)?h((n=t,Array.isArray(n)?[]:{}),t,e):t;var n}function p(t,e,n){return t.concat(e).map(function(t){return l(t,n)})}function h(t,e,n){(n=n||{}).arrayMerge=n.arrayMerge||p,n.isMergeableObject=n.isMergeableObject||f;var r,i,o,s,a=Array.isArray(e),u=Array.isArray(t),c=a===u;return c?a?n.arrayMerge(t,e,n):(r=t,i=e,s={},(o=n).isMergeableObject(r)&&Object.keys(r).forEach(function(t){s[t]=l(r[t],o)}),Object.keys(i).forEach(function(t){o.isMergeableObject(i[t])&&r[t]?s[t]=h(r[t],i[t],o):s[t]=l(i[t],o)}),s):l(e,n)}return h.all=function(t,n){if(!Array.isArray(t))throw new Error("first argument should be an array");return t.reduce(function(t,e){return h(t,e,n)},{})},h}()}),h=Array.isArray,d=Object.keys,y=Object.prototype.hasOwnProperty,c=function t(e,n){if(e===n)return!0;if(e&&n&&"object"==typeof e&&"object"==typeof n){var r,i,o,s=h(e),a=h(n);if(s&&a){if((i=e.length)!=n.length)return!1;for(r=i;0!=r--;)if(!t(e[r],n[r]))return!1;return!0}if(s!=a)return!1;var u=e instanceof Date,c=n instanceof Date;if(u!=c)return!1;if(u&&c)return e.getTime()==n.getTime();var f=e instanceof RegExp,l=n instanceof RegExp;if(f!=l)return!1;if(f&&l)return e.toString()==n.toString();var p=d(e);if((i=p.length)!==d(n).length)return!1;for(r=i;0!=r--;)if(!y.call(n,p[r]))return!1;for(r=i;0!=r--;)if(!t(e[o=p[r]],n[o]))return!1;return!0}return e!=e&&n!=n},e=function(t){this.store=t,this.count=0,this.id=this.store.nextId,this.listeners={}};e.prototype.key=function(t){return(t||[]).join("|")},e.prototype.listen=function(t,e){if(e){var n=e.id||this.store.nextId;return this.listeners[n]={keys:t,listener:e},n}},e.prototype.ignore=function(t){t&&delete this.listeners[t.id]},e.prototype.changed=function(t,e){var n=this,i=[];t.forEach(function(r){var t;for(t in n.listeners)0<(t=n.listeners[t]).keys.filter(function(t){var e=r.join("/"),n=t.join("/");return 0===n.indexOf(e)||0===e.indexOf(n)}).length&&i.push(t.listener)}),i.forEach(function(t){t.updated&&t.updated(e)})},e.prototype.destroy=function(){this.listeners={}};var n=function(t,e,n){this.id=e.nextId,this.storeConfig.apply(this,arguments),this.bootstrap()},r={slice:{configurable:!0},clone:{configurable:!0}};n.prototype.storeConfig=function(t,e,n){var r=t.events||{};this.store=e,this.handler=n,this.map=t.paths,this.targetObj=t.to,this.updateCallback=r.afterUpdate||function(t){},this.defaults=t.withDefaultData||{},this.reactLike=t.isReactFamilyUIComponent,void 0===this.reactLike&&(this.reactLike=this.isReactLike(this.targetObj)||!1)},n.prototype.isReactLike=function(t){return!!t.isReactComponent||"function"==typeof t.setState&&"function"==typeof t.render},n.prototype.listen=function(){var t=[];for(var e in this.map)t.push(this.map[e]);this.handler.listen(t,this)},n.prototype.removeListen=function(){this.handler.ignore(this)},n.prototype.componentWillUnmount=function(){this.reactLike&&(this.orig_componentWillUnmount&&this.orig_componentWillUnmount.apply(this.targetObj,arguments),this.destroy())},n.prototype.revokeComponentWillUnmountHook=function(){this.reactLike&&(this.targetObj.componentWillUnmount=this.orig_componentWillUnmount)},n.prototype.addComponentWillUnmountHook=function(){if(this.reactLike){var t=this.targetObj,e="componentWillUnmount";t[e]&&(this.orig_componentWillUnmount=t[e]),t[e]=this[e].bind(this)}},n.prototype.initialValues=function(){var t,e=this.defaults,n=this.map,r=this.store.data,i=[];for(var o in e)t=n[o],i.push(t),u.set(r,t,e[o]);this.handler.changed(i)},n.prototype.initialize=function(){this.initialValues(),this._assignState()},n.prototype.isNewData=function(t){var e=t.store,n=this.slice;return!c(e,n)},n.prototype._assignState=function(){var t=this.targetObj,e=this.slice;this.reactLike?(t.state=t.state||{},t.state.store=e):t.store=e},n.prototype._updateState=function(){var t=this.targetObj,e=this.slice;this.reactLike?this.targetObj.setState({store:e}):(t.store=e,"function"==typeof this.updateCallback&&this.updateCallback(e))},n.prototype.setState=function(e,t){var n=this,r=this.targetObj;this.reactLike?"function"==typeof e?r.setState(function(t){return(t=e(t)).store&&(n.slice=t.store),t},t):r.setState(e,function(){e.store&&(n.slice=e.store),"function"==typeof t&&t()}):this.slice=e},n.prototype.updated=function(t){t!==this.id&&this.store&&this._updateState()},n.prototype.bootstrap=function(){this.addComponentWillUnmountHook(),this.initialize(),this.listen()},n.prototype.destroy=function(){this.removeListen(),this.revokeComponentWillUnmountHook(),this.map=null,this.targetObj=null,this.defaults=null,this.store=null,this.handler=null},r.slice.get=function(){var t,e,n={},r=this.map,i=this.store.data;for(e in r)t=u.get(i,r[e]),u.set(n,e,t);return n},r.clone.get=function(){return i({},this.slice)},r.slice.set=function(t){var e,n,r,i=this.map,o=[],s=this.slice,a=this.store.data;for(n in i)e=t[n],r=s[n],c(e,r)||(u.set(a,i[n],e),o.push(i[n]));0<o.length&&this.handler.changed(o,this.id)},Object.defineProperties(n.prototype,r);var o={},s=function(t){this.count=0,this.id=this.nextId,this.slicers={},this.handler=new e(this),o[this.id]=t},a={nextId:{configurable:!0},localStores:{configurable:!0},data:{configurable:!0}};return a.nextId.get=function(){return this.count+=1,Date.now()+this.count+""},a.localStores.get=function(){return this.slicers},a.data.get=function(){return o[this.id]},s.prototype.set=function(t,e){var n=this.get(t);n&&c(n,e)||(u.set(this.data,t,e),this.handler.changed([t]))},s.prototype.get=function(t,e){return u.get(this.data,t,e)},s.prototype.coalesce=function(t,e){return u.coalesce(this.data,t,e)},s.prototype.empty=function(t){u.empty(this.data,t),this.handler.changed([t])},s.prototype.insert=function(t,e,n){u.insert(this.data,t,e,n),this.handler.changed([t])},s.prototype.push=function(t){var e=[this.data,t];e.push.apply(e,Array.prototype.slice.call(arguments,1)),u.push.apply(u,e),this.handler.changed([t])},s.prototype.ensureExists=function(t,e){this.has(t)||(u.ensureExists(this.data,t,e),this.handler.changed([t]))},s.prototype.del=function(t){u.del(this.data,t),this.handler.changed([t])},s.prototype.has=function(t){return u.has(this.data,t)},s.prototype.merge=function(t,e,n){if(t&&e){var r=this.get(t);c(r,e)||this.set(t,i(r,e))}},s.prototype.slice=function(t,e,n){void 0===n&&(n={});var r={to:e,paths:t,withDefaultData:n.defaults,events:{afterUpdate:n.updateCallback},isReactFamilyUIComponent:n.reactLike};return this.bind(r)},s.prototype.bind=function(t){void 0===t&&(t={});var e=new n(t,this,this.handler);return this.slicers[e.id]=e,this.slicers[e.id]},s.prototype.destroy=function(){for(var t in this.slicers)this.slicers[t].destroy();this.handler.destroy(),this.slicers={},this.handler=null,delete o[this.id]},Object.defineProperties(s.prototype,a),s});
//# sourceMappingURL=clearx.js.map
